(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[13],{"5f29":function(e,a,t){"use strict";t.r(a);var s=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("q-page",{staticClass:"padding bg-grey-1"},[t("breadcrumbs",{staticClass:"bg-secondary",attrs:{links:e.links}}),t("bibleTools",{attrs:{portion:"OT",toolBar:e.toolBar}})],1)},n=[],i=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("q-page",{staticClass:"padding bg-grey-1"},[e.kjvRightSideBarOpen?t("kjvRightSideBar",{attrs:{mainImmediate:e.mainImmediate,toolBar:e.toolBar,objType:"languages",sideBarOpener:e.sideBarOpener}}):e._e(),t("q-tabs",{attrs:{align:"left"},model:{value:e.languagesTab,callback:function(a){e.languagesTab=a},expression:"languagesTab"}},[t("q-tab",{attrs:{name:"all",label:"All Languages: "+Object.keys(e.versionsObj).length}}),t("q-tab",{attrs:{name:"relevant",label:"Relevant Languages: "+e.relevantLanguageList.length}})],1),t("q-separator"),t("q-table",{attrs:{grid:"","card-container-class":e.cardContainerClass,data:"all"===e.languagesTab?e.languageList:e.relevantLanguageList,columns:e.languageColumns,filter:e.languageFilter,"row-key":"name","hide-header":"","hide-bottom":e.hideBottom},scopedSlots:e._u([{key:"top-right",fn:function(){return[t("q-btn",{attrs:{flat:""}},[t("q-icon",{attrs:{color:"primary",name:"refresh",side:""},on:{click:function(a){return e.loadLanguages()}}})],1),t("q-space"),t("q-input",{attrs:{dense:"",debounce:"300",placeholder:"Search"},model:{value:e.languageFilter,callback:function(a){e.languageFilter=a},expression:"languageFilter"}},[t("q-icon",{attrs:{slot:"append",name:"search"},slot:"append"})],1)]},proxy:!0},{key:"item",fn:function(a){return[t("div",{staticClass:"q-pa-xs col-xs-12 col-sm-6 col-md-4"},[t("q-card",{staticClass:"bg-white"},[t("q-card-section",{staticClass:"flex flex-center"},[t("q-card",{directives:[{name:"ripple",rawName:"v-ripple"}],staticClass:"bg-primary cursor-pointer q-hoverable",staticStyle:{width:"80vw"}},[t("q-card-section",{staticClass:"text-center bg-secondary",on:{click:function(t){return e.selectLanguage(a.row)}}},[t("div",{staticClass:"row"},[t("div",{staticClass:"col-12 no-wrap",staticStyle:{"font-size":"4em"}},[e._v("\n                    "+e._s(a.row.name)+"\n                  ")]),t("div",{staticClass:"absolute-top-right q-ma-md"},[t("div",{staticClass:"row"},[e._v("\n                      "+e._s(a.row.numDownloaded)+" of\n                      "),e._v("\n                      "+e._s(Object.keys(a.row.langVersionsObj).length)+"\n                      Version"+e._s(Object.keys(a.row.langVersionsObj).length>1?"s":"")+"\n                    ")])])])]),t("q-card-section",{staticClass:"flex flex-center text-white",on:{click:function(t){return e.patchLanguage(a.row)}}},[t("div",[e._v("\n                  "+e._s(a.row.name)+"\n                  "+e._s(a.row.fullLanguageName?": "+a.row.fullLanguageName:"")+"\n                  "),t("q-icon",{attrs:{name:"edit"}})],1)])],1)],1)],1)],1)]}}])}),t("q-dialog",{attrs:{maximized:!1,"transition-show":"scale","transition-hide":"scale"},model:{value:e.patchLanguageDialog,callback:function(a){e.patchLanguageDialog=a},expression:"patchLanguageDialog"}},[t("q-card",{staticClass:"q-ma-md"},[t("q-card-section",{staticClass:"bg-secondary text-white text-center"},[t("div",{staticClass:"text-h6"},[e._v("Edit Language")])]),t("q-card-section",{staticClass:"bg-secondary text-white"},[t("q-form",{ref:"editLanguageForm",staticClass:"q-gutter-md text-white",on:{submit:e.submitPatchLanguage,reset:e.onReset}},[t("q-input",{attrs:{filled:"",type:"text",label:"Abbreviation","lazy-rules":"",disable:!0},on:{keyup:function(a){return!a.type.indexOf("key")&&e._k(a.keyCode,"enter",13,a.key,"Enter")?null:e.submit(a)}},model:{value:e.selectedRow.language,callback:function(a){e.$set(e.selectedRow,"language",a)},expression:"selectedRow.language"}}),t("q-input",{attrs:{filled:"",type:"text",label:"Language","lazy-rules":"",rules:[function(e){return e&&e.length>0||"Please enter a language"}]},on:{keyup:function(a){return!a.type.indexOf("key")&&e._k(a.keyCode,"enter",13,a.key,"Enter")?null:e.submit(a)}},model:{value:e.selectedRow.fullLanguageName,callback:function(a){e.$set(e.selectedRow,"fullLanguageName",a)},expression:"selectedRow.fullLanguageName"}}),t("div",[t("q-btn",{attrs:{label:"Submit",type:"submit",color:"primary"}}),t("q-btn",{staticClass:"q-ml-sm",attrs:{label:"Reset",type:"reset",color:"white",flat:""}})],1)],1)],1)],1)],1)],1)},l=[],o=t("ded3"),r=t.n(o),g=(t("ddb0"),t("5319"),t("4e82"),t("e11e"),t("2cbd"));const u=t("c2a1").default,c=t("1712").to,d=(t("0924").default,t("20e6")),h=t("a221")(`./${d.PROJECT.toLowerCase()}/bibleVersions.json`),b=t("a5c4")(`./${d.PROJECT.toLowerCase()}/languages.json`);var m={name:"bibleTools",components:{breadcrumbs:g["a"],kjvRightSideBar:()=>Promise.all([t.e(0),t.e(1)]).then(t.bind(null,"cc6f"))},props:["toolBar"],data(){return{languagesTab:"all",kjvRightSideBarOpen:!1,mainImmediate:this,sideBarOpener:this,selectedRow:{},patchLanguageDialog:!1,numLanguages:0,numRelevantLanguages:0,languageSearch:"",languageList:[],allLanguageList:[],languageFilter:"",languageColumns:[{name:"name",label:"Name",field:"name"},{name:"fullLanguageName",label:"Name",field:"fullLanguageName"},{name:"description",label:"Description",field:"description"},{name:"icon",label:"Icon",field:"icon"},{name:"numVersions",label:"numVersions",field:"numVersions"}],versionsObj:r()({},h)}},async created(){this.loadLanguages(!0)},methods:{selectLanguage(e){this.selectedRow=e,this.kjvRightSideBarOpen=!1,this.$nextTick((()=>this.kjvRightSideBarOpen=!0))},async loadLanguages(e){this.languageList=[],this.versionsObj=r()({},h);for(let t of Object.keys(this.versionsObj))this.versionsObj[t]={name:t,langVersionsObj:this.versionsObj[t],downloadedObj:{},relevant:Object.keys(b).includes(t),fullLanguageName:!!b[t]&&b[t],madeRelevant:!1,selected:!1,numDownloaded:0};for(let t of Object.keys(this.versionsObj))this.languageList.push(this.versionsObj[t]);this.sortLangs();let a=this.languageList.filter((e=>e.relevant)).map((e=>e.name));this.getLangVersions(a,e)},async getLangVersions(e,a){"string"===typeof e&&(e=[e]);for(let t of Object.keys(this.versionsObj))for(let e of Object.keys(this.versionsObj[t].langVersionsObj))this.versionsObj[t].langVersionsObj[e].downloaded=!1;return new Promise((async(t,s)=>{this.sideBarOpener.loadingSomethingBigger=!0;let n=e.map(u.downloadedversions),[i,l]=await c(Promise.all(n));if(this.sideBarOpener.loadingSomethingBigger=!1,i)return s(i);if(l.map((e=>{let{lang:a,versions:t}=e,s=0;for(let n of Object.keys(t))this.versionsObj[a].langVersionsObj[n].downloaded=!0,s++;this.versionsObj[a].numDownloaded=s})),a){let e=window.location.hash.replace(/^[#]*[\/]*/,""),a=e.match(/bible-tools\/([a-zA-Z0-9\-]+)/);if(a){a.shift();let e=a.shift();this.versionsObj[e]&&this.selectLanguage(this.versionsObj[e])}}return t()}))},sortLangs(){this.languageList=this.languageList.sort(((e,a)=>e.name>a.name?1:-1))},async loadLanguagesBac(){this.languageList=[];let e={};Object.keys(h).map((a=>{e[a]=a}));let a={};Object.keys(e).map((e=>{a[e]={name:e,field:e,description:e,numVersions:Object.keys(h[e]).length}}));for(let l in a){let e=a[l];this.languageList.push(e)}this.numLanguages=this.languageList.length,this.toolBar.loadingSomethingBigger=!0;let[t,s]=await c(u.getLanguages());if(this.toolBar.loadingSomethingBigger=!1,t)return;this.tmpLangsObj=a;let n=Object.keys(b);this.languageList=this.languageList.map((e=>{let a=e.name;e.allVersions=h[a],e.numAllVersions=Object.keys(h[a]).length;let t=[],s=Object.keys(h[a]);return s.map((e=>t.push(h[a][e]))),e.notDownloaded=t,e.versions=[],e.installed=0,n.includes(a)&&(e.fullLanguageName=b[a],this.relevantLanguageList.push(e)),e})),this.allLanguageList=[].concat([...this.languageList]);let i=n.map(u.downloadedversions);[t,s]=await c(Promise.all(i)),s&&s.map((e=>{let a=e.lang,t=e.versions;this.languageList=this.languageList.map((e=>{if(e.name===a){let s=[],n=[],i=Object.keys(t),l=JSON.parse(JSON.stringify(h[a]));i.map((e=>{s.push(h[a][e]),delete l[e]})),i=Object.keys(l),i.map((e=>n.push(l[e]))),e.versions=s,e.notDownloaded=n,e.installed=Object.keys(t).length}return e}))})),this.languageList=this.languageList.sort(((e,a)=>e.name>a.name?1:-1))},submit(){this.$refs.editLanguageForm.submit()},onReset(){this.selectedRow=JSON.parse(JSON.stringify(this.selectedOriginal))},async submitPatchLanguage(){let{bibleLanguageId:e,language:a,fullLanguageName:t}=this.selectedRow;if(!e)return void this.$q.notify({message:`${a} has not been saved yet.`,type:"negative"});let s=a;a=t;let[n,i]=await c(u.patchLanguage({abbreviation:s,language:a,bibleLanguageId:e}));if(n)return this.$q.notify({message:`${n}`,type:"negative"});this.$q.notify({message:`${s} has been updated.`,type:"positive"}),this.patchLanguageDialog=!1,this.updateLanguagesList([i])},patchLanguage(e){},updateLanguagesList(e){if(this.toolBar.loadingSomethingBigger=!0,!e)return void(this.toolBar.loadingSomethingBigger=!1);e.map((e=>{let a=e.abbreviation||e.language;if(this.tmpLangsObj[a].language=a,this.tmpLangsObj[a].fullLanguageName=e.language,this.tmpLangsObj[a].saved=!0,void 0!==e.bibleLanguageId){let t=e.bibleLanguageId;this.tmpLangsObj[a].bibleLanguageId=t}})),this.unsavedLangs={},this.languageList=[];let a={};for(let t in this.tmpLangsObj){let e=this.tmpLangsObj[t];e.fullLanguageName!==e.language&&(a[t]=e)}for(let t in this.tmpLangsObj){let e=this.tmpLangsObj[t];e.fullLanguageName===e.language&&(a[t]=e)}this.tmpLangsObj=a;for(let t in this.tmpLangsObj){let e=this.tmpLangsObj[t];this.languageList.push(e),e.saved||(this.unsavedLangs[t]=e)}this.toolBar.loadingSomethingBigger=!1},async saveLanguages(e){return new Promise(((a,t)=>{let s=[],n=[];for(let r in e)10===n.length&&(s.push([...n]),n=[]),n.push(r),n.length===Object.keys(e).length&&(s.push([...n]),n=[]);let i=s.length,l=0;const o=async()=>new Promise((async(e,a)=>{let t=s[l];if(!t)return this.toolBar.loadingSomethingBigger=!1,events.removeListener("next",o),e(!0);let n=t.map((e=>u.saveLanguage({abbreviation:e,language:e}))),[r,g]=await c(Promise.all(n));return++l<i?events.emit("next"):(this.toolBar.loadingSomethingBigger=!1,events.removeListener("next",o)),e(g)}));events.on("next",o),events.emit("next")}))},selectApplication(e){window.location.assign(e)}},watch:{},computed:{relevantLanguageList(){return this.languageList.filter((e=>e.relevant))},hideBottom(){return!("all"===this.languagesTab&&this.languageList.length>10||"relevant"===this.languagesTab&&this.languageList.filter((e=>e.relevant))>10)},cardContainerClass(){if(this.$q.screen.gt.xs)return"grid-masonry grid-masonry--"+(this.$q.screen.gt.sm?"6":"4")}}},p=m,f=t("2877"),L=t("9989"),v=t("429bb"),O=t("7460"),y=t("eb85"),w=t("eaac"),j=t("9c40"),k=t("0016"),B=t("2c91"),q=t("27f9"),x=t("f09f"),C=t("a370"),S=t("24e8"),R=t("0378"),T=t("714f"),N=t("eebe"),_=t.n(N),Q=Object(f["a"])(p,i,l,!1,null,null,null),P=Q.exports;_()(Q,"components",{QPage:L["a"],QTabs:v["a"],QTab:O["a"],QSeparator:y["a"],QTable:w["a"],QBtn:j["a"],QIcon:k["a"],QSpace:B["a"],QInput:q["a"],QCard:x["a"],QCardSection:C["a"],QDialog:S["a"],QForm:R["a"]}),_()(Q,"directives",{Ripple:T["a"]});t("c2a1").default,t("1712").to,t("20e6");var V={name:"bibleToolsPage",components:{bibleTools:P,breadcrumbs:g["a"]},data(){return{main:this,loadingSomethingBigger:!1,tab:"languages",links:[{label:"Publishing",icon:"library_books",to:"/publishing"},{label:"Bible tools",icon:"construction",to:"/bible-tools"}]}},async created(){},props:["toolBar"],methods:{}},$=V,D=t("6b1d"),I=t("adad"),E=t("823b"),F=Object(f["a"])($,s,n,!1,null,null,null);a["default"]=F.exports;_()(F,"components",{QPage:L["a"],QLinearProgress:D["a"],QTabs:v["a"],QTab:O["a"],QSeparator:y["a"],QTabPanels:I["a"],QTabPanel:E["a"]})},a5c4:function(e,a,t){var s={"./gospelsounders/languages.json":"d38e"};function n(e){var a=i(e);return t(a)}function i(e){if(!t.o(s,e)){var a=new Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}return s[e]}n.keys=function(){return Object.keys(s)},n.resolve=i,e.exports=n,n.id="a5c4"},d38e:function(e){e.exports=JSON.parse('{"en":"English","swh":"Swahili","grc":"Greek"}')}}]);